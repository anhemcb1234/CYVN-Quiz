{"ast":null,"code":"import _toConsumableArray from\"D:/test/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"D:/test/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/test/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\test\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from\"react\";import{Link,useSearchParams,useNavigate}from\"react-router-dom\";import{examsServices}from\"../services/examsServices\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Quiz=function Quiz(){var _questions$questionId3,_questions$questionId4,_questions$questionId5,_questions$questionId6,_questions$questionId7,_questions$questionId10;var navigate=useNavigate();var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,1),searchParam=_useSearchParams2[0];var _useState=useState(function(){return searchParam===null||searchParam===void 0?void 0:searchParam.get(\"id\");}),_useState2=_slicedToArray(_useState,2),id=_useState2[0],setId=_useState2[1];var _useState3=useState(function(){return localStorage.getItem(\"idUser\");}),_useState4=_slicedToArray(_useState3,2),idUser=_useState4[0],setIdUser=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),show=_useState6[0],setShow=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),questions=_useState8[0],setQuestions=_useState8[1];var _useState9=useState(function(){return[];}),_useState10=_slicedToArray(_useState9,2),filterSelected=_useState10[0],setFilterSelected=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),questionId=_useState12[0],setQuestionId=_useState12[1];var _useState13=useState(10),_useState14=_slicedToArray(_useState13,2),minutes=_useState14[0],setMinutes=_useState14[1];var _useState15=useState(10),_useState16=_slicedToArray(_useState15,2),second=_useState16[0],setSecond=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),listAnswer=_useState18[0],setListAnswer=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),listsAnswer=_useState20[0],setListAnswers=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),addQuestion=_useState22[0],setAddQuestion=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),check=_useState24[0],setCheck=_useState24[1];var _useState25=useState([]),_useState26=_slicedToArray(_useState25,2),data=_useState26[0],setData=_useState26[1];var _useState27=useState(function(){var _questions$questionId;return(_questions$questionId=questions[questionId])===null||_questions$questionId===void 0?void 0:_questions$questionId.id;}),_useState28=_slicedToArray(_useState27,2),idQuestion=_useState28[0],setIdquestion=_useState28[1];var _useState29=useState(function(){return localStorage.getItem(\"userName\");}),_useState30=_slicedToArray(_useState29,2),userName=_useState30[0],setUserName=_useState30[1];var _useState31=useState([]),_useState32=_slicedToArray(_useState31,2),dataFilter=_useState32[0],setDataFilter=_useState32[1];var red=\"text-rose-600\";var mt=\"flex a justify-between\";if(!localStorage.getItem(\"token\")){alert(\"You must be logged in to access this page\");navigate(\"/\");}var handlerStart=function handlerStart(){setShow(!show);setMinutes(1);setSecond(59);};useEffect(function(){if(second===0){setSecond(59);setMinutes(minutes-1);}var time=setInterval(function(){setSecond(second-1);},1000);return function(){return clearInterval(time);};},[second]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var repsQuestion;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return examsServices.getQuestions(id);case 3:repsQuestion=_context.sent;setQuestions(repsQuestion.data);setId(searchParam===null||searchParam===void 0?void 0:searchParam.get(\"id\"));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}))();},[show]);var handlerPrevious=function handlerPrevious(){setCheck();if(questionId<=0){setQuestionId(questions.length-1);return;}setQuestionId(questionId-1);};useEffect(function(){setListAnswers([].concat(_toConsumableArray(listsAnswer),[listAnswer]));var arr1=getUniqueListBy(listsAnswer,\"question_id\");setAddQuestion(arr1);},[addQuestion]);var handlerNext=function handlerNext(){if(questionId===questions.length-1){setQuestionId(0);return;}setFilterSelected([]);setQuestionId(questionId+1);selectedFilterHandle();};useEffect(function(){var _questions$questionId2;setData([].concat(_toConsumableArray(data),[{question_id:(_questions$questionId2=questions[questionId])===null||_questions$questionId2===void 0?void 0:_questions$questionId2.id,question_type:2,idSingleQuestion:null,listIdAnswer:filterSelected}]));},[filterSelected]);useEffect(function(){var newArray=_toConsumableArray(data).filter(function(x){var _x$listIdAnswer;return(_x$listIdAnswer=x.listIdAnswer)===null||_x$listIdAnswer===void 0?void 0:_x$listIdAnswer.length;});var newArray2=getUniqueListBy(newArray,\"question_id\");setDataFilter(newArray2);},[dataFilter]);useEffect(function(){if(second===0&&minutes===0){handlerSubmit();return;}},[second]);var selectedFilterHandle=function selectedFilterHandle(id,index,item,e){setIdquestion(item===null||item===void 0?void 0:item.question_id);item.checked=!item.checked;if(filterSelected!==null&&filterSelected!==void 0&&filterSelected.includes(index)){var tmp=filterSelected===null||filterSelected===void 0?void 0:filterSelected.filter(function(item){return item!==index;});setFilterSelected(tmp);return;}setFilterSelected([].concat(_toConsumableArray(filterSelected),[index]));};useEffect(function(){var test=_toConsumableArray(questions);test.map(function(x){var _x$answerDTOS;return(_x$answerDTOS=x.answerDTOS)===null||_x$answerDTOS===void 0?void 0:_x$answerDTOS.map(function(y){return y.checked=false;});});setQuestions(test);},[]);function getUniqueListBy(arr,key){return _toConsumableArray(new Map(arr.map(function(item){return[item[key],item];})).values());}var radioFilterHandler=function radioFilterHandler(id){var _testA$questionId,_testA$questionId$ans,_testA$questionId2,_testA$questionId2$an,_testA$questionId3,_testA$questionId3$an,_testA$questionId4,_testA$questionId4$an,_testing$questionId,_testing$questionId$a;var testA=_toConsumableArray(questions);var testing=_toConsumableArray(questions);(_testA$questionId=testA[questionId])===null||_testA$questionId===void 0?void 0:(_testA$questionId$ans=_testA$questionId.answerDTOS)===null||_testA$questionId$ans===void 0?void 0:_testA$questionId$ans.map(function(x){return x.anwer=false;});(_testA$questionId2=testA[questionId])===null||_testA$questionId2===void 0?void 0:(_testA$questionId2$an=_testA$questionId2.answerDTOS)===null||_testA$questionId2$an===void 0?void 0:_testA$questionId2$an.map(function(x){return x.question_type=1;});(_testA$questionId3=testA[questionId])===null||_testA$questionId3===void 0?void 0:(_testA$questionId3$an=_testA$questionId3.answerDTOS)===null||_testA$questionId3$an===void 0?void 0:_testA$questionId3$an.map(function(x){return x.idSingleQuestion=id;});var a=(_testA$questionId4=testA[questionId])===null||_testA$questionId4===void 0?void 0:(_testA$questionId4$an=_testA$questionId4.answerDTOS)===null||_testA$questionId4$an===void 0?void 0:_testA$questionId4$an.find(function(x){return x.id===id;});a.id=id;a.anwer=!a.anwer;var filerList=(_testing$questionId=testing[questionId])===null||_testing$questionId===void 0?void 0:(_testing$questionId$a=_testing$questionId.answerDTOS)===null||_testing$questionId$a===void 0?void 0:_testing$questionId$a.find(function(x){return x.anwer===true;});setListAnswer(filerList);};var handlerSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return examsServices.addQuestions({userId:idUser,examId:id,lstQuestion:[].concat(_toConsumableArray(addQuestion.filter(function(x){return x.id;})),_toConsumableArray(dataFilter))});case 2:navigate(\"/result?id=\".concat(id,\"&idUser=\").concat(idUser));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handlerSubmit(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:show?/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full h-screen justify-center items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-5  right-5\",children:/*#__PURE__*/_jsx(Link,{to:\"/choose-quiz?userName=\".concat(userName),children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded\",children:\"Go to home page\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-xl p-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"font-bold text-5xl text-center text-indigo-700\",children:\"Hackathon Quiz\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex justify-center items-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handlerStart();},className:\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\",children:\"Start\"})})]})]}):/*#__PURE__*/_jsx(\"div\",{id:\"app\",className:\"flex  w-full h-screen justify-center items-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-xl p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"C\\xE2u h\\u1ECFi: \",questionId+1,\"/\",questions.length]}),/*#__PURE__*/_jsxs(\"span\",{className:minutes===0?red+\" countdown font-mono text-2xl\":\"countdown font-mono text-2xl\",children:[minutes===0?\"\":/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{\"--value\":minutes}}),\"m\"]}),/*#__PURE__*/_jsx(\"span\",{style:{\"--value\":second}}),\"s\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-start flex-col\",style:{height:\"17vh\"},children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold w-full text-2xl text-indigo-700\",children:(_questions$questionId3=questions[questionId])===null||_questions$questionId3===void 0?void 0:_questions$questionId3.question_content}),(_questions$questionId4=questions[questionId])!==null&&_questions$questionId4!==void 0&&_questions$questionId4.image_url?/*#__PURE__*/_jsx(\"img\",{className:\"w-full rounded mb-2 h-20 object-cover\",src:\"http://18.136.124.246:9998/images/\"+((_questions$questionId5=questions[questionId])===null||_questions$questionId5===void 0?void 0:_questions$questionId5.image_url)}):null,(_questions$questionId6=questions[questionId])===null||_questions$questionId6===void 0?void 0:(_questions$questionId7=_questions$questionId6.answerDTOS)===null||_questions$questionId7===void 0?void 0:_questions$questionId7.map(function(item,index){var _questions$questionId8,_questions$questionId9;return/*#__PURE__*/_jsxs(\"div\",{className:\"mx-2 flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input mr-2  appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none transition duration-200 align-top bg-no-repeat bg-center bg-contain float-left cursor-pointer\",type:((_questions$questionId8=questions[questionId])===null||_questions$questionId8===void 0?void 0:_questions$questionId8.question_type)==1?\"radio\":\"checkbox\",name:\"flexRadioDefault\",id:item===null||item===void 0?void 0:item.id,value:item===null||item===void 0?void 0:item.id,checked:questions[questionId].question_type==1?item===null||item===void 0?void 0:item.anwer:item===null||item===void 0?void 0:item.checked.checked,onChange:((_questions$questionId9=questions[questionId])===null||_questions$questionId9===void 0?void 0:_questions$questionId9.question_type)==1?function(){return radioFilterHandler(item===null||item===void 0?void 0:item.id);}:function(e){return selectedFilterHandle(item===null||item===void 0?void 0:item.answer_content,item===null||item===void 0?void 0:item.id,item,e);}}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label text-xl inline-block text-gray-800\",for:item===null||item===void 0?void 0:item.id,children:[index+1,\". \",item===null||item===void 0?void 0:item.answer_content]})]},index);})]})}),/*#__PURE__*/_jsxs(\"div\",{className:(_questions$questionId10=questions[questionId])!==null&&_questions$questionId10!==void 0&&_questions$questionId10.image_url?mt+' mt-32':mt+' mt-12',children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handlerPrevious();},className:\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\",children:\"Previous\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handlerNext();},className:\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\",children:\"Next\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full mt-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handlerSubmit();},className:\"float-right w-full hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\",children:\"Finish\"})})]})})});};export default Quiz;","map":{"version":3,"sources":["D:/test/src/pages/Quiz.js"],"names":["React","useEffect","useState","Link","useSearchParams","useNavigate","examsServices","Quiz","navigate","searchParam","get","id","setId","localStorage","getItem","idUser","setIdUser","show","setShow","questions","setQuestions","filterSelected","setFilterSelected","questionId","setQuestionId","minutes","setMinutes","second","setSecond","listAnswer","setListAnswer","listsAnswer","setListAnswers","addQuestion","setAddQuestion","check","setCheck","data","setData","idQuestion","setIdquestion","userName","setUserName","dataFilter","setDataFilter","red","mt","alert","handlerStart","time","setInterval","clearInterval","getQuestions","repsQuestion","console","log","handlerPrevious","length","arr1","getUniqueListBy","handlerNext","selectedFilterHandle","question_id","question_type","idSingleQuestion","listIdAnswer","newArray","filter","x","newArray2","handlerSubmit","index","item","e","checked","includes","tmp","test","map","answerDTOS","y","arr","key","Map","values","radioFilterHandler","testA","testing","anwer","a","find","filerList","addQuestions","userId","examId","lstQuestion","height","question_content","image_url","answer_content"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Link, useSearchParams, useNavigate } from \"react-router-dom\";\r\nimport { examsServices } from \"../services/examsServices\";\r\n\r\nconst Quiz = () => {\r\n  let navigate = useNavigate();\r\n  const [searchParam] = useSearchParams();\r\n  const [id, setId] = useState(() => {\r\n    return searchParam?.get(\"id\");\r\n  });\r\n  const [idUser, setIdUser] = useState(() => {\r\n    return localStorage.getItem(\"idUser\");\r\n  });\r\n  const [show, setShow] = useState(true);\r\n  const [questions, setQuestions] = useState([]);\r\n  const [filterSelected, setFilterSelected] = useState(() => {\r\n    return [];\r\n  });\r\n  const [questionId, setQuestionId] = useState(0);\r\n  const [minutes, setMinutes] = useState(10);\r\n  const [second, setSecond] = useState(10);\r\n  const [listAnswer, setListAnswer] = useState([]);\r\n  const [listsAnswer, setListAnswers] = useState([]);\r\n  const [addQuestion, setAddQuestion] = useState([]);\r\n  const [check, setCheck] = useState(false);\r\n  const [data, setData] = useState([]);\r\n  const [idQuestion, setIdquestion] = useState(() => {\r\n    return questions[questionId]?.id;\r\n  });\r\n  const [userName, setUserName] = useState(() => {\r\n    return localStorage.getItem(\"userName\");\r\n  });\r\n  const [dataFilter, setDataFilter] = useState([]);\r\n  const red = \"text-rose-600\";\r\n  const mt = \"flex a justify-between\"\r\n  if (!localStorage.getItem(\"token\")) {\r\n    alert(\"You must be logged in to access this page\");\r\n    navigate(\"/\");\r\n  }\r\n  const handlerStart = () => {\r\n    setShow(!show);\r\n    setMinutes(1);\r\n    setSecond(59);\r\n  };\r\n  useEffect(() => {\r\n    if (second === 0) {\r\n      setSecond(59);\r\n      setMinutes(minutes - 1);\r\n    }\r\n    let time = setInterval(() => {\r\n      setSecond(second - 1);\r\n    }, 1000);\r\n    return () => clearInterval(time);\r\n  }, [second]);\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        let repsQuestion = await examsServices.getQuestions(id);\r\n        setQuestions(repsQuestion.data);\r\n        setId(searchParam?.get(\"id\"));\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    })();\r\n  }, [show]);\r\n\r\n  const handlerPrevious = () => {\r\n    setCheck();\r\n    if (questionId <= 0) {\r\n      setQuestionId(questions.length - 1);\r\n      return;\r\n    }\r\n    setQuestionId(questionId - 1);\r\n  };\r\n  useEffect(() => {\r\n    setListAnswers([...listsAnswer, listAnswer]);\r\n    const arr1 = getUniqueListBy(listsAnswer, \"question_id\");\r\n    setAddQuestion(arr1);\r\n  }, [addQuestion]);\r\n  const handlerNext = () => {\r\n    if (questionId === questions.length - 1) {\r\n      setQuestionId(0);\r\n      return;\r\n    }\r\n    setFilterSelected([]);\r\n    setQuestionId(questionId + 1);\r\n    selectedFilterHandle();\r\n  };\r\n  useEffect(() => {\r\n    setData([\r\n      ...data,\r\n      {\r\n        question_id: questions[questionId]?.id,\r\n        question_type: 2,\r\n        idSingleQuestion: null,\r\n        listIdAnswer: filterSelected,\r\n      },\r\n    ]);\r\n  }, [filterSelected]);\r\n  useEffect(() => {\r\n    let newArray = [...data].filter((x) => x.listIdAnswer?.length);\r\n    let newArray2 = getUniqueListBy(newArray, \"question_id\");\r\n    setDataFilter(newArray2);\r\n  }, [dataFilter]);\r\n  useEffect(() => {\r\n    if(second === 0 && minutes === 0) {\r\n      handlerSubmit()\r\n      return\r\n    }\r\n  },[second])\r\n  const selectedFilterHandle = (id, index, item, e) => {\r\n    setIdquestion(item?.question_id);\r\n    item.checked = !item.checked;\r\n    if (filterSelected?.includes(index)) {\r\n      const tmp = filterSelected?.filter((item) => item !== index);\r\n      setFilterSelected(tmp);\r\n      return;\r\n    }\r\n    setFilterSelected([...filterSelected, index]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    let test = [...questions];\r\n    test.map((x) => x.answerDTOS?.map((y) => (y.checked = false)));\r\n    setQuestions(test);\r\n  }, []);\r\n  function getUniqueListBy(arr, key) {\r\n    return [...new Map(arr.map((item) => [item[key], item])).values()];\r\n  }\r\n  const radioFilterHandler = (id) => {\r\n    let testA = [...questions];\r\n    let testing = [...questions];\r\n    testA[questionId]?.answerDTOS?.map((x) => (x.anwer = false));\r\n    testA[questionId]?.answerDTOS?.map((x) => (x.question_type = 1));\r\n    testA[questionId]?.answerDTOS?.map((x) => (x.idSingleQuestion = id));\r\n    let a = testA[questionId]?.answerDTOS?.find((x) => x.id === id);\r\n    a.id = id;\r\n    a.anwer = !a.anwer;\r\n    let filerList = testing[questionId]?.answerDTOS?.find(\r\n      (x) => x.anwer === true\r\n    );\r\n    setListAnswer(filerList);\r\n  };\r\n  const handlerSubmit = async () => {\r\n    await examsServices.addQuestions({\r\n      userId: idUser,\r\n      examId: id,\r\n      lstQuestion: [...addQuestion.filter((x) => x.id), ...dataFilter],\r\n    });\r\n    navigate(`/result?id=${id}&idUser=${idUser}`);\r\n  };\r\n  return (\r\n    <>\r\n      {show ? (\r\n        <div className=\"flex w-full h-screen justify-center items-center\">\r\n          <div className=\"absolute top-5  right-5\">\r\n            <Link to={`/choose-quiz?userName=${userName}`}>\r\n              <button className=\"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded\">\r\n                Go to home page\r\n              </button>\r\n            </Link>\r\n          </div>\r\n          <div className=\"w-full max-w-xl p-3\">\r\n            <h1 className=\"font-bold text-5xl text-center text-indigo-700\">\r\n              Hackathon Quiz\r\n            </h1>\r\n            <div className=\"mt-6 flex justify-center items-center\">\r\n              <button\r\n                onClick={() => handlerStart()}\r\n                className=\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\"\r\n              >\r\n                Start\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div\r\n          id=\"app\"\r\n          className=\"flex  w-full h-screen justify-center items-center\"\r\n        >\r\n          <div className=\"w-full max-w-xl p-3\">\r\n            <div className=\"flex justify-between\">\r\n              <p>\r\n                Câu hỏi: {questionId + 1}/{questions.length}\r\n              </p>\r\n              <span\r\n                className={\r\n                  minutes === 0\r\n                    ? red + \" countdown font-mono text-2xl\"\r\n                    : \"countdown font-mono text-2xl\"\r\n                }\r\n              >\r\n                {minutes === 0 ? (\r\n                  \"\"\r\n                ) : (\r\n                  <>\r\n                    <span style={{ \"--value\": minutes }}></span>m\r\n                  </>\r\n                )}\r\n                <span style={{ \"--value\": second }}></span>s\r\n              </span>\r\n            </div>\r\n            <div\r\n              className=\"flex justify-start flex-col\"\r\n              style={{ height: \"17vh\" }}\r\n            >\r\n              <>\r\n                <p className=\"font-bold w-full text-2xl text-indigo-700\">\r\n                  {questions[questionId]?.question_content}\r\n                </p>\r\n                {questions[questionId]?.image_url ? <img className=\"w-full rounded mb-2 h-20 object-cover\" src={\"http://18.136.124.246:9998/images/\"+questions[questionId]?.image_url}/> : null}\r\n                {questions[questionId]?.answerDTOS?.map((item, index) => (\r\n                  <div className=\"mx-2 flex items-center\" key={index}>                    \r\n                    <input\r\n                      className=\"form-check-input mr-2  appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none transition duration-200 align-top bg-no-repeat bg-center bg-contain float-left cursor-pointer\"\r\n                      type={\r\n                        questions[questionId]?.question_type == 1\r\n                          ? \"radio\"\r\n                          : \"checkbox\"\r\n                      }\r\n                      name=\"flexRadioDefault\"\r\n                      id={item?.id}\r\n                      value={item?.id}\r\n                      checked={\r\n                        questions[questionId].question_type == 1\r\n                          ? item?.anwer\r\n                          : item?.checked.checked\r\n                      }\r\n                      onChange={\r\n                        questions[questionId]?.question_type == 1\r\n                          ? () => radioFilterHandler(item?.id)\r\n                          : (e) =>\r\n                              selectedFilterHandle(\r\n                                item?.answer_content,\r\n                                item?.id,\r\n                                item,\r\n                                e\r\n                              )\r\n                      }\r\n                    />\r\n                    <label\r\n                      className=\"form-check-label text-xl inline-block text-gray-800\"\r\n                      for={item?.id}\r\n                    >\r\n                      {index + 1}. {item?.answer_content}\r\n                    </label>\r\n                  </div>\r\n                ))}\r\n              </>\r\n            </div>\r\n            <div className={questions[questionId]?.image_url ? mt + ' mt-32' :  mt + ' mt-12'}>\r\n              <button\r\n                onClick={() => handlerPrevious()}\r\n                className=\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\"\r\n              >\r\n                Previous\r\n              </button>\r\n              <button\r\n                onClick={() => handlerNext()}\r\n                className=\"float-right hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\"\r\n              >\r\n                Next\r\n              </button>\r\n            </div>\r\n            <div className=\"w-full mt-4\">\r\n              <button\r\n                onClick={() => handlerSubmit()}\r\n                className=\"float-right w-full hover:bg-violet-600 active:bg-violet-700 focus:outline-none focus:ring focus:ring-violet-300 bg-indigo-600 text-white text-sm font-bold tracking-wide rounded-full px-5 py-2\"\r\n              >\r\n                Finish\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\nexport default Quiz;\r\n"]},"metadata":{},"sourceType":"module"}